import{_ as y,$ as a,a0 as g,a1 as _,a2 as o,af as r,a8 as l,ac as d,a3 as u,a4 as p,Q as P,a9 as v,aa as k,ag as q,ad as x,ah as Q,ak as N,al as C}from"./index.534612a3.js";import{Q as B}from"./QSpinnerDots.43034d1d.js";import{Q as S}from"./QBadge.0c11437b.js";import{Q as w}from"./QImg.a5adf003.js";import{Q as A}from"./QPage.1888b0c5.js";const F={name:"BuscarResultados",data(){return{productos:[],isFetched:!1,currentPage:Number(this.$route.query.page)||1,totalPages:1}},computed:{routeQ(){return this.$route.query.q||""}},mounted(){this.fetchResultados()},watch:{"$route.query.q"(){this.search=this.$route.query.q||"",this.currentPage=Number(this.$route.query.page)||1,this.fetchResultados()},"$route.query.page"(){this.currentPage=Number(this.$route.query.page)||1,this.fetchResultados()}},methods:{async fetchResultados(){var m,f;const s=(this.$route.query.q||"").trim(),c=Number(this.$route.query.page)||1;if(!s){this.productos=[],this.isFetched=!0,this.totalPages=1;return}this.loading=!0,this.isFetched=!1;try{const{data:e}=await this.$axios.get("productos",{params:{search:s,page:c}}),n=Array.isArray(e.data)?e.data:((m=e.products)==null?void 0:m.data)||[];this.totalPages=e.last_page||((f=e.products)==null?void 0:f.last_page)||1,this.productos=n.map(t=>{const i={...t};if(Number(i.porcentaje)>0){i.precioNormal=i.precio;const b=i.precio-i.precio*i.porcentaje/100;i.precio=Number(b).toFixed(2)}return i})}catch(e){console.error("Error buscando productos",e),this.productos=[],this.totalPages=1}finally{this.loading=!1,this.isFetched=!0}},cambiarPagina(s){s<1||s>this.totalPages||this.$router.push({path:"/buscar",query:{q:this.routeQ,page:s}})},clickDetalleProducto(s){this.$router.push("/detalle-producto/"+s.id+"/"+this.espacioCambioGuion(s.nombre))},espacioCambioGuion(s){return s.replace(/ |\/|\./g,"-").replace(/,/g,"")}}},h=s=>(N("data-v-2d59ceef"),s=s(),C(),s),R={class:"page-wrapper q-pa-md"},I={class:"encabezado"},j={class:"titulo"},z={key:0,class:"subtitulo"},D={key:0,class:"pagination-controls text-center q-mt-sm"},V={key:1,class:"text-center q-mt-xl"},E={key:2,class:"text-center q-mt-xl"},G=h(()=>o("div",{class:"text-h6 q-mt-md"},"No se encontraron productos",-1)),L={key:3,class:"contenedor-productos"},T={class:"products-grid"},H={key:0,class:"out-of-stock-overlay"},J=h(()=>o("span",{class:"out-of-stock-text"},"Sin Stock",-1)),K=[J],M={class:"product-name"},O={class:"product-prices"},U={key:0,class:"price-old"},W=h(()=>o("span",null,"Antes",-1)),X=h(()=>o("br",null,null,-1)),Y={class:"price-now"},Z=h(()=>o("span",null,"Ahora",-1)),$=h(()=>o("br",null,null,-1)),ee={key:0,class:"pagination-controls text-center q-mt-lg"};function te(s,c,m,f,e,n){return a(),g(A,{class:"q-pa-none"},{default:_(()=>[o("div",R,[o("div",I,[o("h1",j,"Resultados para \u201C"+r(n.routeQ)+"\u201D",1),e.isFetched?(a(),l("div",z,r(e.productos.length)+" resultado(s) \xB7 P\xE1gina "+r(e.currentPage)+" / "+r(e.totalPages),1)):d("",!0)]),e.totalPages>1?(a(),l("div",D,[u(p,{flat:"",label:"Anterior",disabled:e.currentPage===1,onClick:c[0]||(c[0]=t=>n.cambiarPagina(e.currentPage-1))},null,8,["disabled"]),o("span",null,r(e.currentPage)+" / "+r(e.totalPages),1),u(p,{flat:"",label:"Siguiente",disabled:e.currentPage===e.totalPages,onClick:c[1]||(c[1]=t=>n.cambiarPagina(e.currentPage+1))},null,8,["disabled"])])):d("",!0),s.loading?(a(),l("div",V,[u(B,{size:"50px",color:"primary"})])):e.isFetched&&e.productos.length===0?(a(),l("div",E,[u(P,{name:"sentiment_dissatisfied",size:"80px",color:"grey-5"}),G])):(a(),l("div",L,[o("div",T,[(a(!0),l(v,null,k(e.productos,t=>(a(),g(q,{key:t.id,class:"product-card-personalizada",flat:"",onClick:i=>n.clickDetalleProducto(t)},{default:_(()=>[u(w,{src:t.imagen.includes("http")?t.imagen:`${s.$url}../images/${t.imagen}`,style:{height:"160px","object-fit":"cover",position:"relative"}},{default:_(()=>[t.cantidad===0?(a(),l("div",H,K)):d("",!0),t.porcentaje?(a(),g(S,{key:1,color:"red",floating:""},{default:_(()=>[x(" -"+r(t.porcentaje)+"% ",1)]),_:2},1024)):d("",!0)]),_:2},1032,["src"]),u(Q,{class:"q-pa-sm text-center"},{default:_(()=>[o("div",M,r(t.nombre),1),o("div",O,[t.precioNormal?(a(),l("div",U,[W,X,o("strong",null,"Bs. "+r(t.precioNormal),1)])):d("",!0),o("div",Y,[Z,$,o("strong",null,"Bs. "+r(t.precio),1)])])]),_:2},1024),t.cantidad>0?(a(),g(p,{key:0,label:"A\xF1adir al carrito",icon:"shopping_cart",class:"q-mt-sm full-width cta-add",glossy:"",unelevated:"","no-caps":""})):(a(),g(p,{key:1,label:"Agotado",icon:"remove_shopping_cart",class:"q-mt-sm full-width cta-off",unelevated:"","no-caps":"",disabled:""}))]),_:2},1032,["onClick"]))),128))]),e.totalPages>1?(a(),l("div",ee,[u(p,{flat:"",label:"Anterior",disabled:e.currentPage===1,onClick:c[2]||(c[2]=t=>n.cambiarPagina(e.currentPage-1))},null,8,["disabled"]),o("span",null,r(e.currentPage)+" / "+r(e.totalPages),1),u(p,{flat:"",label:"Siguiente",disabled:e.currentPage===e.totalPages,onClick:c[3]||(c[3]=t=>n.cambiarPagina(e.currentPage+1))},null,8,["disabled"])])):d("",!0)]))])]),_:1})}var ie=y(F,[["render",te],["__scopeId","data-v-2d59ceef"]]);export{ie as default};
