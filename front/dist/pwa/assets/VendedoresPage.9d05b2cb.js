import{_ as C,o as m,k as g,w as t,y as x,a as e,p as c,q as d,P as p,f as i,Q,g as f,i as w,j as v,Y as E,A as u,t as b,c as P,z as _,n as V,R as S,s as q,v as A,T as N,O as z,e as B,Z as y}from"./index.3cd01b8b.js";const M={name:"VendedoresPage",data(){return{vendedores:[],proveedores:[],proveedoresAll:[],loading:!1,loadingSubmit:!1,dialog:!1,editMode:!1,filter:"",vendedor:{id:null,nombre:"",celular:"",client_id:null},columns:[{name:"id",label:"#",field:"id",sortable:!0,align:"left",style:"width: 50px"},{name:"proveedor",label:"Empresa / Proveedor",field:l=>{var r;return((r=l.client)==null?void 0:r.nombreRazonSocial)||"N/A"},align:"left",sortable:!0},{name:"nombre",label:"Nombre Vendedor",field:"nombre",align:"left",sortable:!0},{name:"celular",label:"Celular",field:"celular",align:"left"},{name:"actions",label:"Acciones",field:"actions",align:"right"}]}},mounted(){this.getVendedores(),this.getProveedores()},methods:{getVendedores(){this.loading=!0,this.$axios.get("vendedores").then(l=>{this.vendedores=l.data}).catch(l=>{var r,a;this.$alert.error(((a=(r=l.response)==null?void 0:r.data)==null?void 0:a.message)||"Error al cargar vendedores")}).finally(()=>{this.loading=!1})},getProveedores(){this.$axios.get("providers").then(l=>{this.proveedores=l.data,this.proveedoresAll=l.data}).catch(l=>{console.error(l)})},filterProveedores(l,r){if(l===""){r(()=>{this.proveedores=this.proveedoresAll});return}r(()=>{const a=l.toLowerCase();this.proveedores=this.proveedoresAll.filter(h=>h.nombreRazonSocial.toLowerCase().indexOf(a)>-1)})},clickCreate(){this.editMode=!1,this.vendedor={nombre:"",celular:"",client_id:null},this.dialog=!0},clickEdit(l){this.editMode=!0,this.vendedor={...l},l.client&&(this.vendedor.client_id=l.client.id),this.dialog=!0},onSubmit(){this.loadingSubmit=!0,this.editMode?this.$axios.put(`vendedores/${this.vendedor.id}`,this.vendedor).then(()=>{this.$alert.success("Vendedor actualizado correctamente"),this.getVendedores(),this.dialog=!1}).catch(l=>{console.error(l),this.$alert.error("Error al actualizar")}).finally(()=>{this.loadingSubmit=!1}):this.$axios.post("vendedores",this.vendedor).then(()=>{this.$alert.success("Vendedor creado correctamente"),this.getVendedores(),this.dialog=!1}).catch(l=>{console.error(l),this.$alert.error("Error al crear")}).finally(()=>{this.loadingSubmit=!1})},clickDelete(l){this.$q.dialog({title:"Confirmar eliminaci\xF3n",message:`\xBFSeguro que deseas eliminar a <b>${l.nombre}</b>?`,html:!0,cancel:!0,persistent:!0}).onOk(()=>{this.$axios.delete(`vendedores/${l.id}`).then(()=>{this.$alert.success("Eliminado correctamente"),this.getVendedores()}).catch(r=>{console.error(r),this.$alert.error("No se pudo eliminar")})})}}},D={class:"row items-center"},R=d("div",{class:"text-h6"},"Gesti\xF3n de Vendedores",-1),T={key:1,class:"text-grey"},U={class:"text-h6"},I={class:"row q-col-gutter-md"},F={class:"col-12"},O={class:"col-12"},j={class:"col-12"},G={class:"row justify-end q-mt-md"};function L(l,r,a,h,s,n){return m(),g(x,{class:"q-pa-md bg-grey-2"},{default:t(()=>[e(V,null,{default:t(()=>[e(c,null,{default:t(()=>[d("div",D,[R,e(p),e(i,{color:"primary",icon:"add",label:"Nuevo Vendedor",onClick:n.clickCreate,unelevated:""},null,8,["onClick"])])]),_:1}),e(c,{class:"q-pa-none"},{default:t(()=>[e(Q,{rows:s.vendedores,columns:s.columns,"row-key":"id",loading:s.loading,filter:s.filter,flat:"",bordered:""},{"top-right":t(()=>[e(f,{borderless:"",dense:"",debounce:"300",modelValue:s.filter,"onUpdate:modelValue":r[0]||(r[0]=o=>s.filter=o),placeholder:"Buscar"},{append:t(()=>[e(w,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-proveedor":t(o=>[e(v,{props:o},{default:t(()=>[o.row.client?(m(),g(E,{key:0,color:"blue"},{default:t(()=>[u(b(o.row.client.nombreRazonSocial),1)]),_:2},1024)):(m(),P("span",T,"Sin asignar"))]),_:2},1032,["props"])]),"body-cell-actions":t(o=>[e(v,{props:o,"auto-width":""},{default:t(()=>[e(i,{flat:"",round:"",dense:"",color:"orange",icon:"edit",onClick:k=>n.clickEdit(o.row)},{default:t(()=>[e(_,null,{default:t(()=>[u("Editar")]),_:1})]),_:2},1032,["onClick"]),e(i,{flat:"",round:"",dense:"",color:"negative",icon:"delete",onClick:k=>n.clickDelete(o.row)},{default:t(()=>[e(_,null,{default:t(()=>[u("Eliminar")]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","filter"])]),_:1})]),_:1}),e(B,{modelValue:s.dialog,"onUpdate:modelValue":r[4]||(r[4]=o=>s.dialog=o),persistent:""},{default:t(()=>[e(V,{style:{"min-width":"400px"}},{default:t(()=>[e(c,{class:"row items-center"},{default:t(()=>[d("div",U,b(s.editMode?"Editar Vendedor":"Nuevo Vendedor"),1),e(p),S(e(i,{icon:"close",flat:"",round:"",dense:""},null,512),[[y]])]),_:1}),e(c,{class:"q-pt-none"},{default:t(()=>[e(q,{onSubmit:n.onSubmit},{default:t(()=>[d("div",I,[d("div",F,[e(A,{modelValue:s.vendedor.client_id,"onUpdate:modelValue":r[1]||(r[1]=o=>s.vendedor.client_id=o),options:s.proveedores,"option-value":"id","option-label":"nombreRazonSocial",label:"Seleccionar Proveedor (Empresa)",outlined:"",dense:"","emit-value":"","map-options":"",rules:[o=>!!o||"El proveedor es obligatorio"],"use-input":"",onFilter:n.filterProveedores},{"no-option":t(()=>[e(N,null,{default:t(()=>[e(z,{class:"text-grey"},{default:t(()=>[u("Sin resultados")]),_:1})]),_:1})]),_:1},8,["modelValue","options","rules","onFilter"])]),d("div",O,[e(f,{modelValue:s.vendedor.nombre,"onUpdate:modelValue":r[2]||(r[2]=o=>s.vendedor.nombre=o),label:"Nombre Completo del Vendedor",outlined:"",dense:"",rules:[o=>!!o||"El nombre es obligatorio"]},null,8,["modelValue","rules"])]),d("div",j,[e(f,{modelValue:s.vendedor.celular,"onUpdate:modelValue":r[3]||(r[3]=o=>s.vendedor.celular=o),label:"Celular (WhatsApp)",type:"number",outlined:"",dense:"",rules:[o=>!!o||"El celular es obligatorio"]},null,8,["modelValue","rules"])])]),d("div",G,[S(e(i,{label:"Cancelar",color:"grey",flat:"",class:"q-mr-sm"},null,512),[[y]]),e(i,{label:s.editMode?"Actualizar":"Guardar",color:"primary",type:"submit",loading:s.loadingSubmit},null,8,["label","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Y=C(M,[["render",L]]);export{Y as default};
